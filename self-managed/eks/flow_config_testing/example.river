      //Metrics and Logs scraping sources
      discovery.kubernetes "discover_pods" {
        //Type of k8s resource to scrape (pod, service, etc)
        role = "pod"
        namespaces {
          //Search within the same namespace Grafana agent is in?
          own_namespace = false
          //Namespaces to search
          names         = ["default","kube-system","consul"]
          }
      }
      //Metrics scraping forwarder
      prometheus.scrape "scrape_pods" {
        targets    = discovery.kubernetes.discover_pods.targets
        forward_to = [prometheus.remote_write.mimir_server.receiver]
      }
      //Logs scraping forwarder
      loki.source.kubernetes "pods" {
        targets    = discovery.kubernetes.discover_pods.targets
        forward_to = [loki.write.loki_server.receiver]
      }
      prometheus.remote_write "mimir_server" {
        endpoint {
          url = "http://mimir-gateway.grafana.svc.cluster.local:80/api/v1/push"
        }
      }
      //Logs scraping destinations
      loki.write "loki_server" {
        endpoint {
          url = "http://loki.grafana.svc.cluster.local:3100/api/v1/push"
        }
      }